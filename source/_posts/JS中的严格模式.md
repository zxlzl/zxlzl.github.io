---
title: JS中的严格模式
date: 2019-03-18 14:21:08  
categories: JavaScript  
tags:
---

## "use strict"

&#160; &#160; &#160; &#160;`"use strict"`是`ECMAScript`引入的一条指令。指令不是语句（但非常接近于语句）。

##### 1. 与普通语句的区别
&#160; &#160; &#160; &#160;`"use strict"`指令和普通的语句之间有两个重要的`区别`：
 - 它不包含任何语言的`关键字`，指令仅仅是一个包含一个特殊字符串直接量的表达式（可以是使用单引号也可以使用双引号），对于那些没有实现`ECMAScript5`的JavaScript的解释器来说，它只是一条没有副作用的表达式语句，它什么也没做。将来的ECMAScript标准希望将use用做关键字，这样就可以省略引号了。
 -  它只能出现在脚本代码的开始或者函数体的开始，任何实体语句之前。但它不必一定出现在脚本的首行或函数体内的首行，因为`"use strict"`指令之后或之前都可以能有其它字符串直接量表达式语句，并且JavaScript的具体实现可能将它们解析为解释器自有的指令。在脚本或者函数体内第一条常规语句之后字符串直接量表达式语句只当做普通的表达式语句对待；它们不会当做指令解析，它们也没有任何副作用。

##### 2. 指令的目的
&#160; &#160; &#160; &#160;使用`"use strict"`指令的目的是说明（脚本或函数中）后续的代码将会解析为严格代码`(strict code)`.如果顶层（不在任何函数内的）代码使用了`"use strict"`指令，那么它们就是严格代码。如果函数体内定义所处的代码是严格代码或者函数体使用了`"use strict"`指令，那么函数体的代码也是严格代码。如果`eval()`调用时所处的代码是严格代码或者`eval()`要执行的字符串中使用了`"use strict"`指令，则`eval()`内的代码是严格代码。

##### 3. 与非严格模式的区别
&#160; &#160; &#160; &#160;严格代码以严格模式执行。`ECMAScript5`中的严格模式是该语言的一个受限制的子集，它修正了语言的重要缺陷，并提供健壮的查错功能和增强的安全机制。严格模式和非严格模式之间的区别如下（前三条十分重要）。
 -  在严格模式中禁止使用`with`语句。
 - 在严格模式中，`所有的变量`都要首先声明，如果给一个未声明的变量、函数、函数参数、catch从句参数或全局对象的属性赋值，将会抛出一个引用错误异常（在非严格模式中，这种隐式声明的全局变量的方法是给全局对象新添加一个新属性）。
 - 在严格模式中，调用的函数（不是方法）中的一个`this`值是`undefined`。（在非严格模式中，调用的函数中的this值总是全局对象）。可以利用这种特殊来判断JavaScript实现是否支持严格模式。
 ```
var hasStrictMode = (function(){ "use strict"; return this===undefined}());
```
 - 同样，在严格模式中，当通过`call()`或者`apply()`来调用函数时，其中的this值就是通过`call()`或者`apply()`传入的第一个参数（在非严格模式中，null和undefined值被全局对象和转换为对象的非对象值所代替）。
 - 在严格模式中，给只读属性赋值和给不可扩展的对象穿件新成员都将抛出一个类型错误异常（在非严格模式中，这些操作知识简单地操作失败，不会报错）。
 - 在严格模式中，传入`eval()`的代码不能再调用程序所在的上下文中声明变量或定义函数，而在费严格模式中是可以这样做得。相反，变量和函数的定义都是在`eval()`创建的新作用域中，这个作用域在`eval()`返回时就弃用了。
 - 在严格模式中，函数里的`arguments`对象拥有传入函数值的静态副本。在非严格模式中，`arguments`对象具有`“魔术般”`的行为，`arguments`里的数组元素和函数参数都是指向同一个值的引用。
 - 在严格模式中，当`delete`运算符后跟随非法的标识符（比如变量、函数、函数参数）时，将会抛出一个语法错误异常（在非严格模式中，这种`delete`表达式什么也没做，并返回false）。
 - 在严格模式中，试图删除一个不可配置的属性将会抛出一个类型错误异常（在非严格模式中，`delete`表达式操作失败，并返回false）。
 - 在严格模式中，在一个对象直接量中定义两个或多个同名属性将产生一个语法错误（在非严格模式中不会报错）。
 - 在严格模式中，函数声明中个存在两个或多个同名的参数将产生一个语法错误（在非严格模式中不会报错）。
 - 在严格模式中是不允许使用八进制整数直接量（以0为前缀，而不是以0x为前缀）的（在非严格模式中某些实现是允许八进制整数直接量的）。
 - 在严格模式中，标识符`eval`和`arguments`当做关键字，他们的值是不能更改的。不能给这些标识符赋值，也不能把它们声明为变量、用做函数名、用做函数参数或用做`catch`块的标识符。
 - 在严格模式中限制了对调用栈的检测能力，在严格模式的函数中，`arguments`、`caller`和`argument.callee`都会抛出一个类型错误异常。严格模式的函数同样据用`caller`和`arguments`属性，当访问这两个属性时将抛出类型错误异常（有一些JavaScript的实现在非严格模式里定义了这些非标准的属性）。


